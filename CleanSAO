def clean_sao(filename):
    df = pd.read_csv(filename)
    
    dropcols = ['VICTIM_ID', "AGENCY_NAME", 'STATE', 'UCN_COUNTY_CODE', 'CORRELATION_ID', 'UNIQUE_CORRELATION_ID']
    drug_keywords = ['Drug', 'Heroin', 'Cocaine', 'Marijuana', 'Opium', 'Amphetamine', 'Hallucinogen', 'Narcotic']
    theft_keywords = ['Robbery', 'Theft', 'Burglary', 'Stolen', 'Shoplift', 'Larceny']
    timecols = ['DEF_PROSEC_PRETRIAL_DIVER_AGREE_DATE', 'CASE_CREATED_DATE', 'FINAL_DECISION']
    bad_outcomes = ["Administratively Dismissed", "Transferred to Another Court", "Consolidated", "Pre-Trial Diversion"]
    charge_code = {'Filed Pending Court':1,'Dropped or Abandoned':0,'No Action':0,'Nolle Prossed':0 }
    
    df.drop(dropcols, axis = 1, inplace = True)
    
    df.replace(np.nan, None, inplace = True)
    df.replace('Unknown', None, inplace = True)
    
    df.drop_duplicates(inplace = True)
    
    df['YEAR'] = pd.to_datetime(df.FINAL_DECISION).dt.year.astype('int')
    df = df[df.YEAR > 2011]
    
    for col in timecols:
        df[col] = pd.to_datetime(df[col]).dt.date.astype('datetime64[ns]')
        
    droprows = np.where(df.FINAL_ACTION_DESC.str.contains('|'.join(bad_outcomes)))[0].tolist()
    df = df.drop(droprows).reset_index(drop = True)
    
    df = df.replace({"FINAL_ACTION_DESC": charge_code}) 
    
    drug1 = np.where(df.DEF_STATUTE_CHAPTER_GROUPING.str.contains('|'.join(drug_keywords)))[0].tolist()
    drug2 = np.where(df.OFFENSE_FCIC_TYPE_DESC.str.contains('|'.join(drug_keywords)))[0].tolist()
    theft1 = np.where(df.DEF_STATUTE_CHAPTER_GROUPING.str.contains('|'.join(theft_keywords)))[0].tolist()
    theft2 = np.where(df.OFFENSE_FCIC_TYPE_DESC.str.contains('|'.join(theft_keywords)))[0].tolist()
    drugsubset = list(set().union(drug1, drug2))
    theftsubset = list(set().union(theft1, theft2))

    drug_df = df.iloc[drugsubset].reset_index(drop = True)
    theft_df = df.iloc[theftsubset].reset_index(drop = True)
    
    return drug_df, theft_df
